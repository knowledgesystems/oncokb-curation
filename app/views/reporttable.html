<div ng-if="fileSelected && isXLSX" class="row" style="margin-bottom: 40px">
    <h3>Upload File Info</h3>
    <p>Number of Sheets: {{ sheets.length }}</p>
    <div ng-repeat="(key, value) in sheets.arr">
        <h5>{{key}}</h5>
        <table class="table">
            <thead>
            <tr>
                <th ng-repeat="title in sheets.attr[key]">
                    {{title}}
                </th>
                <th></th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="datum in value" ng-switch on="key">
                <td ng-repeat="columnKey in sheets.attr[key]">{{datum[columnKey]}}
                </td>
                <td>
                    <i ng-show="workers[$index].generated===1 && !workers[$index].generating" class="fa fa-check" ></i>
                    <i ng-show="workers[$index].generating" class="fa fa-spinner fa-spin"></i>
                    <span style="color: red" ng-show="!workers[$index].generating && workers[$index].generated===-1">Failed</span>
                    <i ng-show="workers[$index].generated===0 && !workers[$index].generating && !working" class="fa fa-trash-o" ng-click="deleteItem(key, datum, 'sheet')"></i>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
<div>
    <div>
        Generate progress:
        <progressbar class="progress-striped active" value="progress.value" type="info"><span style="color: black"><i>{{progress.dynamic}} / {{progress.max}}</i></span></progressbar>
    </div>
    <button type="button" id="rg-rfr-btn" class="btn btn-success btn-s pull-right" ng-disabled="working" ng-click="regenerate()" ng-disabled="!sheets.length" ng-show="hasFailed">
        <span ng-hide="working"><span class="glyphicon glyphicon-upload"></span>Regenerate failed reports</span><i ng-show="working" class="fa fa-spinner fa-spin"></i>
    </button>
    <button type="button" class="btn btn-success btn-s pull-right" ng-disabled="working" ng-click="generate()" ng-disabled="!sheets.length" ng-hide="hasFailed">
        <span ng-hide="working"><span class="glyphicon glyphicon-upload"></span>Generate all reports</span><i ng-show="working" class="fa fa-spinner fa-spin"></i>
    </button>
</div>
    